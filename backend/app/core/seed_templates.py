"""
ê¸°ë³¸ ì •ë¦¬ë²• ì‹œë“œ ë°ì´í„°
"""

from sqlalchemy.orm import Session
from app.models.organize_template import OrganizeTemplate, OutputStructure
from app.models.user import UserPlan


SYSTEM_TEMPLATES = [
    {
        "name": "ê¸°ë³¸ ìš”ì•½ ì •ë¦¬",
        "description": "í•µì‹¬ ë‚´ìš©ì„ ê°„ê²°í•˜ê²Œ ì •ë¦¬í•´ìš”",
        "icon": "ğŸ“‹",
        "prompt": """í•„ê¸°ë¥¼ ì •ë¦¬í•´ì£¼ì„¸ìš”.

[í•„ìˆ˜ ê·œì¹™]
- ë¸”ë¡ID, ì¢Œí‘œ ë“± ë©”íƒ€ë°ì´í„°ëŠ” ì¶œë ¥ì—ì„œ ì™„ì „íˆ ì œê±°
- [bX], (y:XX) ê°™ì€ í˜•ì‹ ì ˆëŒ€ ì¶œë ¥ ê¸ˆì§€
- ê¹”ë”í•œ ë§ˆí¬ë‹¤ìš´ìœ¼ë¡œë§Œ ì¶œë ¥
- ì›ë³¸ ë‚´ìš© ê¸°ë°˜ìœ¼ë¡œ ì •ë¦¬

[ê·¸ë£¹í•‘ ê·œì¹™]
- ê´€ë ¨ëœ ë‚´ìš©ì€ ê°™ì€ ì„¹ì…˜ìœ¼ë¡œ ë¬¶ê¸°
- ì„¸ë¶€ ê°œë…ì€ ìƒìœ„ ì£¼ì œ ì•„ë˜ í•˜ìœ„ í•­ëª©ìœ¼ë¡œ ë°°ì¹˜
- ì‹œëŒ€/êµ­ê°€/ì£¼ì œê°€ ê°™ìœ¼ë©´ í•˜ë‚˜ì˜ ì„¹ì…˜ìœ¼ë¡œ í†µí•©
- í•„ê¸° ìˆœì„œë³´ë‹¤ ë…¼ë¦¬ì  ì—°ê²°ì„ ìš°ì„ 

[ì¶œë ¥ í˜•ì‹]
# ì œëª©

## ì†Œì œëª©1
- í•µì‹¬ ë‚´ìš©
- ì„¸ë¶€ ë‚´ìš©

## ì†Œì œëª©2
- í•µì‹¬ ë‚´ìš©""",
        "system_message": "í•™ìƒ í•„ê¸° ì •ë¦¬. ë©”íƒ€ë°ì´í„° ì œê±°. ê¹”ë”í•œ ë§ˆí¬ë‹¤ìš´ë§Œ.",
        "output_structure": OutputStructure.MARKDOWN,
        "required_plan": UserPlan.FREE,
        "subject": None,
    },
    {
        "name": "ì½”ë„¬ì‹ ì •ë¦¬",
        "description": "í‚¤ì›Œë“œ + ë³¸ë¬¸ + ìš”ì•½ êµ¬ì¡°ë¡œ ì•”ê¸°ì— ìµœì í™”",
        "icon": "ğŸ“",
        "prompt": """í•„ê¸°ë¥¼ ì½”ë„¬ì‹ ë…¸íŠ¸ë¡œ ì •ë¦¬í•´ì£¼ì„¸ìš”.

[ì¶œë ¥ í˜•ì‹ - ë°˜ë“œì‹œ JSON]
```json
{
  "title": "ì œëª© (ë‚´ìš© ê¸°ë°˜ ìë™ ìƒì„±)",
  "cues": ["í‚¤ì›Œë“œ1", "í‚¤ì›Œë“œ2", "í•µì‹¬ìš©ì–´"],
  "main": [
    {"type": "heading", "level": 2, "content": "ì†Œì œëª©"},
    {"type": "paragraph", "content": "ì„¤ëª… í…ìŠ¤íŠ¸"},
    {"type": "bullet", "items": ["í•­ëª©1", "í•­ëª©2", "í•­ëª©3"]},
    {"type": "important", "content": "ì¤‘ìš” ê°œë… ê°•ì¡°"},
    {"type": "example", "content": "ì˜ˆì‹œ ë‚´ìš©"}
  ],
  "summary": "ì „ì²´ ë‚´ìš©ì„ 1-2ë¬¸ì¥ìœ¼ë¡œ ì••ì¶•í•œ ìš”ì•½"
}
```

[ê·œì¹™]
- cuesëŠ” ì•”ê¸°ìš© í•µì‹¬ í‚¤ì›Œë“œ/ìš©ì–´ë§Œ (5-10ê°œ)
- ë¬¸ì¥ì´ë‚˜ ì§ˆë¬¸ í˜•íƒœ X, ë‹¨ì–´/ìš©ì–´ í˜•íƒœë¡œë§Œ
- mainì€ ë…¼ë¦¬ì  ìˆœì„œë¡œ êµ¬ì„±
- ë§ˆí¬ë‹¤ìš´ ë¬¸ë²• ì‚¬ìš©í•˜ì§€ ë§ ê²ƒ""",
        "system_message": "ì½”ë„¬ì‹ ë…¸íŠ¸ ì •ë¦¬. JSON í˜•ì‹ìœ¼ë¡œë§Œ ì¶œë ¥.",
        "output_structure": OutputStructure.CORNELL_JSON,
        "required_plan": UserPlan.FREE,
        "subject": None,
    },
    {
        "name": "ì˜ì–´ ë‹¨ì–´ì¥",
        "description": "ë‹¨ì–´ + ëœ» + ì˜ˆë¬¸ì„ í‘œë¡œ ì •ë¦¬",
        "icon": "ğŸ“š",
        "prompt": """í•„ê¸°ë¥¼ ì˜ì–´ ë‹¨ì–´ì¥ í˜•ì‹ìœ¼ë¡œ ì •ë¦¬í•´ì£¼ì„¸ìš”.

[ì¶œë ¥ í˜•ì‹]
# [ë‹¨ì›/ì£¼ì œ] ë‹¨ì–´ì¥

| ë‹¨ì–´ | í’ˆì‚¬ | ëœ» | ì˜ˆë¬¸ |
|------|------|-----|------|
| word | n. | ëœ» | Example sentence |

## ì£¼ìš” í‘œí˜„
- **í‘œí˜„**: ëœ», ì‚¬ìš©ë²•

## ë¬¸ë²• í¬ì¸íŠ¸
- ê´€ë ¨ ë¬¸ë²• ì„¤ëª…

[ê·œì¹™]
- ëª¨ë“  ë‹¨ì–´ì— í’ˆì‚¬ í‘œê¸° (n. v. adj. adv. ë“±)
- ì˜ˆë¬¸ì€ í•´ë‹¹ ë‹¨ì–´ í™œìš©
- ê´€ë ¨ í‘œí˜„ë„ í•¨ê»˜ ì •ë¦¬""",
        "system_message": "ì˜ì–´ ë‹¨ì–´ì¥ í˜•ì‹ìœ¼ë¡œ ì •ë¦¬. í‘œ í˜•ì‹ ì‚¬ìš©.",
        "output_structure": OutputStructure.TABLE,
        "required_plan": UserPlan.FREE,
        "subject": "english",
    },
    {
        "name": "ë¹„êµí‘œ ì •ë¦¬",
        "description": "ì—¬ëŸ¬ ê°œë…ì„ í‘œë¡œ ë¹„êµ ë¶„ì„",
        "icon": "âš–ï¸",
        "prompt": """í•„ê¸°ì—ì„œ ë¹„êµí•  ìˆ˜ ìˆëŠ” ê°œë…ë“¤ì„ ì°¾ì•„ í‘œë¡œ ì •ë¦¬í•´ì£¼ì„¸ìš”.

[ì¶œë ¥ í˜•ì‹]
# [ì£¼ì œ] ë¹„êµ ë¶„ì„

## ê°œë… ë¹„êµí‘œ
| êµ¬ë¶„ | ê°œë…A | ê°œë…B | ê°œë…C |
|------|-------|-------|-------|
| ì •ì˜ | ... | ... | ... |
| íŠ¹ì§• | ... | ... | ... |
| ì¥ì  | ... | ... | ... |
| ë‹¨ì  | ... | ... | ... |
| ì˜ˆì‹œ | ... | ... | ... |

## ê³µí†µì 
- ê³µí†µë˜ëŠ” íŠ¹ì§•

## ì°¨ì´ì 
- í•µì‹¬ ì°¨ì´ì  ì •ë¦¬

## í•µì‹¬ ìš”ì•½
- í•œëˆˆì— ë³´ëŠ” ì •ë¦¬""",
        "system_message": "ë¹„êµí‘œ í˜•ì‹ìœ¼ë¡œ ì •ë¦¬. í‘œì™€ ë§ˆí¬ë‹¤ìš´ í˜¼ìš©.",
        "output_structure": OutputStructure.TABLE,
        "required_plan": UserPlan.BASIC,
        "subject": None,
    },
    {
        "name": "ì‹œí—˜ ëŒ€ë¹„ ì •ë¦¬",
        "description": "ì¶œì œ í¬ì¸íŠ¸ ì¤‘ì‹¬ìœ¼ë¡œ ì •ë¦¬ + ì˜ˆìƒ ë¬¸ì œ",
        "icon": "ğŸ¯",
        "prompt": """í•„ê¸°ë¥¼ ì‹œí—˜ ëŒ€ë¹„ìš©ìœ¼ë¡œ ì •ë¦¬í•´ì£¼ì„¸ìš”.

[ì¶œë ¥ í˜•ì‹]
# [ë‹¨ì›] ì‹œí—˜ ëŒ€ë¹„ ì •ë¦¬

## í•µì‹¬ ê°œë… (ì¶œì œ ë¹ˆë„ ë†’ìŒ)
- **ê°œë…1**: ì •ì˜ ë° ì„¤ëª…
- **ê°œë…2**: ì •ì˜ ë° ì„¤ëª…

## ìì£¼ ë‚˜ì˜¤ëŠ” ìœ í˜•
1. ìœ í˜•1: ì„¤ëª…
2. ìœ í˜•2: ì„¤ëª…

## í—·ê°ˆë¦¬ê¸° ì‰¬ìš´ ë¶€ë¶„
- ì£¼ì˜í•  ì  ì •ë¦¬

## ì•”ê¸° í¬ì¸íŠ¸
- ê¼­ ì™¸ì›Œì•¼ í•  ê²ƒë“¤

## ì˜ˆìƒ ë¬¸ì œ
1. [ê°ê´€ì‹] ë¬¸ì œ ë‚´ìš©
   - ì •ë‹µ: Xë²ˆ
   - í•´ì„¤: ì„¤ëª…

2. [ë‹¨ë‹µí˜•] ë¬¸ì œ ë‚´ìš©
   - ì •ë‹µ: ë‹µ

[ê·œì¹™]
- ì‹œí—˜ ì¶œì œì ê´€ì ìœ¼ë¡œ ë¶„ì„
- ì˜ˆìƒ ë¬¸ì œ 3-5ê°œ ìƒì„±""",
        "system_message": "ì‹œí—˜ ëŒ€ë¹„ ì •ë¦¬. ì¶œì œ í¬ì¸íŠ¸ ë¶„ì„ + ì˜ˆìƒ ë¬¸ì œ í¬í•¨.",
        "output_structure": OutputStructure.MARKDOWN,
        "required_plan": UserPlan.PRO,
        "subject": None,
    },
    {
        "name": "ìˆ˜í•™ ê°œë… ì •ë¦¬",
        "description": "ê³µì‹ + í’€ì´ ê³¼ì • + ì˜ˆì œ ì¤‘ì‹¬",
        "icon": "ğŸ”¢",
        "prompt": """ìˆ˜í•™ í•„ê¸°ë¥¼ ì •ë¦¬í•´ì£¼ì„¸ìš”.

[í•„ìˆ˜ ê·œì¹™]
- LaTeX ê¸ˆì§€ (ì œê³±ì€ x^2 ë˜ëŠ” xÂ² ìœ ë‹ˆì½”ë“œ ì‚¬ìš©)
- ìˆ˜í•™ ê¸°í˜¸: +, -, x, /, =, <, >, <=, >= ë“± ì‚¬ìš©
- ë¶„ìˆ˜ëŠ” a/b í˜•íƒœë¡œ

[ì¶œë ¥ í˜•ì‹]
# [ë‹¨ì›ëª…] ê°œë… ì •ë¦¬

## í•µì‹¬ ê³µì‹
- **ê³µì‹1**: ìˆ˜ì‹
  - ì˜ë¯¸: ì„¤ëª…
  - ì¡°ê±´: ì ìš© ì¡°ê±´

## ê°œë… ì„¤ëª…
- ê°œë… ì •ì˜
- ê´€ë ¨ ì„±ì§ˆ

## í’€ì´ ì˜ˆì‹œ
**ì˜ˆì œ**: ë¬¸ì œ
**í’€ì´**:
1) ë‹¨ê³„1
2) ë‹¨ê³„2
3) ë‹¨ê³„3
**ì •ë‹µ**: ë‹µ

## ì£¼ì˜ì‚¬í•­
- ìì£¼ ì‹¤ìˆ˜í•˜ëŠ” ë¶€ë¶„""",
        "system_message": "ìˆ˜í•™ ê°œë… ì •ë¦¬. LaTeX ê¸ˆì§€. ìœ ë‹ˆì½”ë“œ ìˆ˜í•™ê¸°í˜¸ ì‚¬ìš©.",
        "output_structure": OutputStructure.MARKDOWN,
        "required_plan": UserPlan.FREE,
        "subject": "math",
    },
]


def seed_templates(db: Session):
    """ê¸°ë³¸ ì •ë¦¬ë²• ì‹œë“œ"""
    existing = db.query(OrganizeTemplate).filter(OrganizeTemplate.is_system == True).count()

    if existing > 0:
        print(f"[SEED] Templates already exist ({existing}), skipping...")
        return

    for template_data in SYSTEM_TEMPLATES:
        template = OrganizeTemplate(
            name=template_data["name"],
            description=template_data["description"],
            icon=template_data["icon"],
            prompt=template_data["prompt"],
            system_message=template_data["system_message"],
            output_structure=template_data["output_structure"],
            required_plan=template_data["required_plan"],
            subject=template_data["subject"],
            is_system=True,
        )
        db.add(template)

    db.commit()
    print(f"[SEED] Created {len(SYSTEM_TEMPLATES)} system templates")

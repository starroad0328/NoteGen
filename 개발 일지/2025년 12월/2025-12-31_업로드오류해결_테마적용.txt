================================================================
NotioClass 개발 일지 - 2025년 12월 31일
================================================================

작업 내용: 업로드 네트워크 오류 해결, 수학 검산 추가, 노트 UI 테마 적용


----------------------------------------------------------------
1. 네트워크 업로드 오류 해결
----------------------------------------------------------------

문제:
  - 노트 정리 버튼 클릭 시 "Network Error" (ERR_NETWORK)
  - 서버는 200 OK 반환했으나 모바일에서 응답 수신 실패

원인:
  - axios가 React Native FormData를 제대로 처리하지 못함
  - Content-Type 헤더가 boundary 없이 설정됨

해결:
  - axios → fetch API로 변경
  - Content-Type 헤더 제거 (브라우저가 boundary 자동 설정)
  - 업로드 timeout 30초 → 120초로 증가

수정 파일:
  - mobile/services/api.ts


----------------------------------------------------------------
2. 수학 오답노트 프롬프트 개선
----------------------------------------------------------------

문제:
  - AI가 수학 풀이 검산 없이 틀린 답 출력

개선:
  - **올바른 풀이** 섹션 추가 (단계별 상세 풀이)
  - **검산** 섹션 추가 (정답을 원래 조건에 대입 확인)
  - [검산 필수!] 규칙 추가
    - 근과 계수: 구한 값으로 합/곱 다시 계산
    - 방정식: 해를 원래 식에 대입
    - 함수: 값 대입해 좌변=우변 확인

수정 파일:
  - backend/app/prompts/math_error_note.txt


----------------------------------------------------------------
3. OCR 블록 병합 tolerance 증가
----------------------------------------------------------------

목적:
  - 수학 필기는 간격이 좁아서 블록이 너무 잘게 쪼개지는 문제

변경:
  - 같은 줄 판정: avg_height * 0.7 → 0.8
  - 같은 블록 판정: avg_height * 1.8 → 2.0

수정 파일:
  - backend/app/services/ocr_service.py


----------------------------------------------------------------
4. 노트 상세 화면 테마 색상 적용
----------------------------------------------------------------

변경 내용:
  - [id].tsx: 헤더, 태그바, 푸터, 드로어에 테마 색상 적용
  - NoteRenderer.tsx: colors prop 추가, 배경색 동적 적용
  - NoteBlockRenderer.tsx: 모든 블록 컴포넌트 테마 색상 적용

적용된 블록:
  - 제목, 소제목, 본문, 리스트
  - 키워드, 요약, 예시, 공식, 정의
  - 문제, 풀이, 틀린 포인트, 관련 개념
  - 단어장 블록

테마 색상:
  - primary: #C4956A (갈색)
  - text: #5D4E37
  - textLight: #8B7355
  - accent: #E8B866

수정 파일:
  - mobile/app/notes/[id].tsx
  - mobile/components/note/NoteRenderer.tsx
  - mobile/components/note/NoteBlockRenderer.tsx


----------------------------------------------------------------
5. AI 프롬프트 문서화
----------------------------------------------------------------

신규 파일:
  - 개발 규칙과 메모/AI 정리 프롬프트.txt

내용:
  - 수학 오답노트 프롬프트
  - 일반 오답노트 프롬프트
  - 영어 단어장 프롬프트
  - 프롬프트 선택 로직
  - 플랜별 AI 모델
  - 취약 개념 추출 (Pro 전용)


----------------------------------------------------------------
커밋 내역
----------------------------------------------------------------

4fd634d feat: Pro 개인화 시스템 - 취약 개념 추적
25d0ec1 feat: 보관함 과목 필터 및 자동 제목 생성 기능


================================================================

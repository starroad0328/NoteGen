═══════════════════════════════════════════════════════════════
                    개발 일지 - 2025년 12월 21일
═══════════════════════════════════════════════════════════════

작업 브랜치: feature/improve-organize-quality (main 머지 완료)


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 완료된 작업
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. OCR 정제 LLM 단계 추가 (0단계)
   - GPT-5 nano를 활용한 텍스트 정제
   - 띄어쓰기 복원, 잘린 글자 합치기
   - 3단계 파이프라인: 정제 → 구조 분석 → 정리

2. 블록 메타데이터 출력 제거
   - [bX] (y:XX) 형식이 결과에 출력되던 문제 해결
   - 깔끔한 마크다운으로만 출력되도록 프롬프트 수정

3. AI 단계별 진행 상태 표시
   - on_step 콜백으로 DB에 progress_message 저장
   - [1/3], [2/3], [3/3] 형식으로 단계 표시
   - Note 모델에 progress_message 필드 추가

4. 노트 복사 버튼 추가
   - expo-clipboard 설치
   - 정리된 내용 클립보드 복사 기능

5. 폴링 간격 최적화
   - 2초 → 0.8초로 변경
   - AI 단계 변화를 더 잘 잡을 수 있도록


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 기술적 변경사항
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[ Backend ]

ai_service.py:
  - _step0_refine_ocr() 메서드 추가
  - organize_note()에 on_step 콜백 파라미터 추가
  - 정리 프롬프트에서 메타데이터 출력 금지 규칙 추가

process.py:
  - on_ai_step 콜백 함수 정의
  - progress_message DB 업데이트 로직

models/user.py:
  - AIModel.GPT_5_NANO 추가 ("gpt-5-nano-2025-08-07")

models/note.py:
  - progress_message 필드 추가

[ Mobile ]

app/notes/[id].tsx:
  - expo-clipboard import
  - handleCopy() 함수 추가
  - 복사 버튼 UI 추가

app/processing/[id].tsx:
  - BASE_DELAY: 2000 → 800


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 현재 AI 파이프라인
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

이미지 업로드
    ↓
CLOVA OCR (텍스트 + bbox 추출)
    ↓
0단계: OCR 정제 (GPT-5 nano, 3000 토큰)
    ↓
1단계: 구조 파악 (GPT-5 mini, 3000 토큰)
    ↓
2단계: 정리 생성 (GPT-5 mini, 6000 토큰)
    ↓
결과 반환


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 추가 작업 (로그인 + 학년 기능)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 로그인/회원가입 기능 구현
   - JWT 토큰 기반 인증
   - passlib (bcrypt) + python-jose
   - expo-secure-store로 토큰 저장

2. 학년 선택 UI 추가
   - 회원가입 시 학교급(중/고) + 학년(1,2,3) 선택
   - 홈 화면에 학년 배지 표시
   - 업로드 화면에 교육과정 반영 안내

3. 교육과정 데이터 설계
   - 2022 개정 교육과정 기준
   - 중학교 1~3학년 과목별 주요 토픽
   - 고등학교 1~3학년 과목별 주요 토픽

4. AI 프롬프트에 학년/교육과정 반영
   - 학습자 정보 컨텍스트 주입
   - 학년에 맞는 용어와 개념 사용
   - 관련 교과 내용 연결 설명


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 추가된 파일
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[ Backend ]
- app/models/base.py           : 공유 SQLAlchemy Base
- app/services/auth_service.py : 인증 서비스 (JWT, 해싱)
- app/schemas/auth.py          : 인증 스키마
- app/api/auth.py              : 인증 API 엔드포인트
- app/core/curriculum.py       : 교육과정 데이터

[ Mobile ]
- contexts/AuthContext.tsx     : 인증 상태 관리
- app/login.tsx                : 로그인 화면
- app/register.tsx             : 회원가입 화면 (학년 선택)


═══════════════════════════════════════════════════════════════

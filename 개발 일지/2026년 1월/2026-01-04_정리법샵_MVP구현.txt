================================================================
NotioClass 개발 일지 - 2026년 1월 4일
================================================================

작업 내용: 정리법샵 MVP 구현 + 오답노트 V2 연기


----------------------------------------------------------------
1. 오답노트 기능 V2로 연기
----------------------------------------------------------------

목적:
  - 개발 방향 조정 - 오답노트는 V2에서 새로운 방식으로 구현 예정
  - 현재 버전에서는 정리법샵에 집중

변경 내용:
  - 업로드 화면에서 오답노트 선택 옵션 제거
  - 백엔드 process.py에서 needs_confirmation = False 설정
  - AI 정리 프롬프트 문서에서 오답노트 섹션 제거

V2 계획:
  - 취약 개념 추출 방식 변경
  - 기존: 오답노트에서 직접 추출
  - 변경: 필기 기반 문제 생성 → 틀린 문제에서 취약 개념 추출

수정 파일:
  - mobile/app/(tabs)/upload.tsx (오답노트 옵션 제거)
  - backend/app/api/process.py (confirmation 비활성화)


----------------------------------------------------------------
2. 정리법샵 기본 구현
----------------------------------------------------------------

목적:
  - 사용자가 정리법을 선택해서 정리에 적용할 수 있게 함
  - 플랜별 정리법 잠금/해제 시스템

구현 내용:
  - OrganizeTemplate 모델 (name, description, icon, prompt, required_plan 등)
  - 정리법 목록 API (/api/templates)
  - 정리법 상세 API (/api/templates/{id})
  - 과목/정렬 필터링 (인기순, 최신순)
  - 시스템 정리법 6개 시드 데이터
    - 기본 요약 정리 (Free)
    - 코넬식 정리 (Free)
    - 영어 단어장 (Free, english)
    - 수학 개념 정리 (Free, math)
    - 비교표 정리 (Basic)
    - 시험 대비 정리 (Pro)


----------------------------------------------------------------
3. 정리법 구독 기능
----------------------------------------------------------------

목적:
  - 정리법샵에서 구독한 정리법을 업로드 화면에서 선택 가능하게 함

구현 내용:
  - UserTemplateSubscription 모델 (user_id, template_id)
  - 구독 API: POST /api/templates/{id}/subscribe
  - 구독 해제 API: DELETE /api/templates/{id}/subscribe
  - 구독 목록 API: GET /api/templates/subscribed/list
  - 업로드 화면에 "구독한 정리법" 섹션 추가

수정 파일:
  - backend/app/models/organize_template.py
  - backend/app/api/templates.py
  - mobile/app/(tabs)/upload.tsx
  - mobile/services/api.ts


----------------------------------------------------------------
4. 정리법 상세 모달 및 좋아요 기능
----------------------------------------------------------------

목적:
  - 정리법 클릭 시 상세 정보(설명, 프롬프트) 확인 가능
  - 좋아요(하트) 기능으로 인기 정리법 표시

구현 내용:

  [백엔드]
  - like_count 컬럼 추가 (OrganizeTemplate)
  - UserTemplateLike 모델 (user_id, template_id)
  - 좋아요 API: POST /api/templates/{id}/like
  - 좋아요 취소 API: DELETE /api/templates/{id}/like
  - 좋아요 목록 API: GET /api/templates/liked/list
  - API 라우트 순서 수정 (/subscribed/list, /liked/list를 /{id} 앞으로)

  [프론트엔드]
  - 정리법 카드 클릭 시 하단 모달 팝업
  - 모달 내용: 아이콘, 이름, 플랜 뱃지, 사용 횟수, 좋아요 수
  - 설명 및 프롬프트 전문 표시
  - 하트 버튼 (카드/모달 양쪽에서 좋아요 가능)
  - 모달에서 바로 구독/구독 해제 가능

수정 파일:
  - backend/app/models/organize_template.py
  - backend/app/models/__init__.py
  - backend/app/api/templates.py
  - backend/app/schemas/template.py
  - mobile/app/templates.tsx
  - mobile/services/api.ts


----------------------------------------------------------------
5. 발생한 이슈 및 해결
----------------------------------------------------------------

이슈 1: API 404 에러 (Failed to load templates)
  - 원인: /subscribed/list, /liked/list 라우트가 /{template_id} 뒤에 정의됨
         FastAPI가 "subscribed", "liked"를 template_id로 인식
  - 해결: 고정 경로를 /{template_id} 앞으로 이동


----------------------------------------------------------------
6. 테스트 결과
----------------------------------------------------------------

  - 정리법샵 목록 로딩 정상
  - 과목/정렬 필터 동작 확인
  - 정리법 클릭 시 상세 모달 표시
  - 좋아요 토글 및 카운트 업데이트
  - 구독/구독 해제 동작
  - 업로드 화면에 구독한 정리법 표시


----------------------------------------------------------------
커밋 내역
----------------------------------------------------------------

7e7e67b refactor: 오답노트 기능 V2로 연기
a4c7372 feat: 정리법샵 MVP 구현
6d8928e feat: 정리법샵 상세 모달 및 좋아요 기능 추가


================================================================
